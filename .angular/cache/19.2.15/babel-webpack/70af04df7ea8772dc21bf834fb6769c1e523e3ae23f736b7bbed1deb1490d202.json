{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { UserFormComponent } from './user-form.component';\nimport { of, switchMap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../core/services/user.service\";\nimport * as i3 from \"@angular/common\";\nfunction UserEditComponent_div_0_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r2.toastMessage);\n  }\n}\nfunction UserEditComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"h5\", 4);\n    i0.ɵɵelement(3, \"i\", 5);\n    i0.ɵɵtext(4, \" Edit User\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 6)(6, \"app-user-form\", 7);\n    i0.ɵɵlistener(\"submitUser\", function UserEditComponent_div_0_Template_app_user_form_submitUser_6_listener($event) {\n      const user_r2 = i0.ɵɵrestoreView(_r1).ngIf;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onSubmit($event, user_r2));\n    })(\"cancel\", function UserEditComponent_div_0_Template_app_user_form_cancel_6_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onCancel());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, UserEditComponent_div_0_div_7_Template, 2, 1, \"div\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const user_r2 = ctx.ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"user\", user_r2)(\"mode\", \"edit\")(\"availableRoles$\", ctx_r2.availableRoles$);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.toastMessage);\n  }\n}\nfunction UserEditComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"div\", 11);\n    i0.ɵɵelementStart(2, \"div\", 12);\n    i0.ɵɵtext(3, \"Loading user...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class UserEditComponent {\n  constructor(route, userService, router) {\n    this.route = route;\n    this.userService = userService;\n    this.router = router;\n    this.toastMessage = null;\n    this.availableRoles$ = this.userService.getAvailableRoles();\n    this.user$ = this.route.paramMap.pipe(switchMap(params => {\n      const id = params.get('id');\n      if (!id) return of(null);\n      return this.userService.getAll().pipe(switchMap(users => of(users.find(u => u.id === id) || null)));\n    }));\n  }\n  onSubmit(formValue, user) {\n    const updatedUser = {\n      ...user,\n      ...formValue,\n      updatedAt: new Date()\n    };\n    this.userService.update(user.id, updatedUser).subscribe({\n      next: () => {\n        this.showToast('User updated successfully!');\n        setTimeout(() => this.router.navigate(['../../'], {\n          relativeTo: this.route\n        }), 1200);\n      },\n      error: () => {\n        this.showToast('Failed to update user.', true);\n      }\n    });\n  }\n  onCancel() {\n    this.router.navigate(['../../'], {\n      relativeTo: this.route\n    });\n  }\n  showToast(message, error = false) {\n    this.toastMessage = message;\n    if (error) {\n      this.toastMessage += '';\n    }\n    clearTimeout(this.toastTimeout);\n    this.toastTimeout = setTimeout(() => {\n      this.toastMessage = null;\n    }, 2000);\n  }\n  static {\n    this.ɵfac = function UserEditComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || UserEditComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i1.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: UserEditComponent,\n      selectors: [[\"app-user-edit\"]],\n      decls: 4,\n      vars: 4,\n      consts: [[\"loading\", \"\"], [\"class\", \"card mb-4\", 4, \"ngIf\", \"ngIfElse\"], [1, \"card\", \"mb-4\"], [1, \"card-header\"], [1, \"mb-0\"], [1, \"fas\", \"fa-user-edit\", \"me-2\"], [1, \"card-body\"], [3, \"submitUser\", \"cancel\", \"user\", \"mode\", \"availableRoles$\"], [\"class\", \"toast-message fade-in mt-3\", 4, \"ngIf\"], [1, \"toast-message\", \"fade-in\", \"mt-3\"], [1, \"text-center\", \"py-5\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-primary\"], [1, \"mt-2\"]],\n      template: function UserEditComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, UserEditComponent_div_0_Template, 8, 4, \"div\", 1);\n          i0.ɵɵpipe(1, \"async\");\n          i0.ɵɵtemplate(2, UserEditComponent_ng_template_2_Template, 4, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        }\n        if (rf & 2) {\n          const loading_r4 = i0.ɵɵreference(3);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 2, ctx.user$))(\"ngIfElse\", loading_r4);\n        }\n      },\n      dependencies: [CommonModule, i3.NgIf, i3.AsyncPipe, UserFormComponent],\n      styles: [\".toast-message[_ngcontent-%COMP%] {\\n  background: var(--color-accent);\\n  color: var(--color-text-light);\\n  padding: 0.75rem 1.5rem;\\n  border-radius: 0.5rem;\\n  box-shadow: var(--color-shadow);\\n  font-weight: 500;\\n  position: relative;\\n  z-index: 10;\\n  min-width: 200px;\\n  text-align: center;\\n  animation: _ngcontent-%COMP%_fadeIn 0.4s;\\n}\\n\\n.toast-message.error[_ngcontent-%COMP%] {\\n  background: #dc2626;\\n}\\n\\n.fade-in[_ngcontent-%COMP%] {\\n  animation: _ngcontent-%COMP%_fadeIn 0.4s;\\n}\\n\\n@keyframes _ngcontent-%COMP%_fadeIn {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvdXNlcnMvdXNlci1lZGl0LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsK0JBQUE7RUFDQSw4QkFBQTtFQUNBLHVCQUFBO0VBQ0EscUJBQUE7RUFDQSwrQkFBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLHNCQUFBO0FBQ0Y7O0FBQ0E7RUFDRSxtQkFBQTtBQUVGOztBQUFBO0VBQ0Usc0JBQUE7QUFHRjs7QUFEQTtFQUNFO0lBQU8sVUFBQTtFQUtQO0VBSkE7SUFBSyxVQUFBO0VBT0w7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIi50b2FzdC1tZXNzYWdlIHtcclxuICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1hY2NlbnQpO1xyXG4gIGNvbG9yOiB2YXIoLS1jb2xvci10ZXh0LWxpZ2h0KTtcclxuICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTtcclxuICBib3JkZXItcmFkaXVzOiAwLjVyZW07XHJcbiAgYm94LXNoYWRvdzogdmFyKC0tY29sb3Itc2hhZG93KTtcclxuICBmb250LXdlaWdodDogNTAwO1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICB6LWluZGV4OiAxMDtcclxuICBtaW4td2lkdGg6IDIwMHB4O1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICBhbmltYXRpb246IGZhZGVJbiAwLjRzO1xyXG59XHJcbi50b2FzdC1tZXNzYWdlLmVycm9yIHtcclxuICBiYWNrZ3JvdW5kOiAjZGMyNjI2O1xyXG59XHJcbi5mYWRlLWluIHtcclxuICBhbmltYXRpb246IGZhZGVJbiAwLjRzO1xyXG59XHJcbkBrZXlmcmFtZXMgZmFkZUluIHtcclxuICBmcm9tIHsgb3BhY2l0eTogMDsgfVxyXG4gIHRvIHsgb3BhY2l0eTogMTsgfVxyXG59ICJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"names":["CommonModule","UserFormComponent","of","switchMap","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","ctx_r2","toastMessage","ɵɵelement","ɵɵlistener","UserEditComponent_div_0_Template_app_user_form_submitUser_6_listener","$event","user_r2","ɵɵrestoreView","_r1","ngIf","ɵɵnextContext","ɵɵresetView","onSubmit","UserEditComponent_div_0_Template_app_user_form_cancel_6_listener","onCancel","ɵɵtemplate","UserEditComponent_div_0_div_7_Template","ɵɵproperty","availableRoles$","UserEditComponent","constructor","route","userService","router","getAvailableRoles","user$","paramMap","pipe","params","id","get","getAll","users","find","u","formValue","user","updatedUser","updatedAt","Date","update","subscribe","next","showToast","setTimeout","navigate","relativeTo","error","message","clearTimeout","toastTimeout","ɵɵdirectiveInject","i1","ActivatedRoute","i2","UserService","Router","selectors","decls","vars","consts","template","UserEditComponent_Template","rf","ctx","UserEditComponent_div_0_Template","UserEditComponent_ng_template_2_Template","ɵɵtemplateRefExtractor","ɵɵpipeBind1","loading_r4","i3","NgIf","AsyncPipe","styles"],"sources":["C:\\Users\\ibrahim\\Desktop\\projectPort-new\\src\\app\\features\\users\\user-edit.component.ts","C:\\Users\\ibrahim\\Desktop\\projectPort-new\\src\\app\\features\\users\\user-edit.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { UserService } from '../../core/services/user.service';\r\nimport { UserFormComponent } from './user-form.component';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { User } from '../../core/models/user.model';\r\n\r\n@Component({\r\n  selector: 'app-user-edit',\r\n  standalone: true,\r\n  imports: [CommonModule, UserFormComponent],\r\n  templateUrl: './user-edit.component.html',\r\n  styleUrls: ['./user-edit.component.scss']\r\n})\r\nexport class UserEditComponent {\r\n  user$: Observable<User | null>;\r\n  availableRoles$: Observable<string[]>;\r\n  toastMessage: string | null = null;\r\n  toastTimeout: any;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private userService: UserService,\r\n    private router: Router\r\n  ) {\r\n    this.availableRoles$ = this.userService.getAvailableRoles();\r\n    this.user$ = this.route.paramMap.pipe(\r\n      switchMap(params => {\r\n        const id = params.get('id');\r\n        if (!id) return of(null);\r\n        return this.userService.getAll().pipe(\r\n          switchMap(users => of(users.find(u => u.id === id) || null))\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n  onSubmit(formValue: any, user: User) {\r\n    const updatedUser = { ...user, ...formValue, updatedAt: new Date() };\r\n    this.userService.update(user.id, updatedUser).subscribe({\r\n      next: () => {\r\n        this.showToast('User updated successfully!');\r\n        setTimeout(() => this.router.navigate(['../../'], { relativeTo: this.route }), 1200);\r\n      },\r\n      error: () => {\r\n        this.showToast('Failed to update user.', true);\r\n      }\r\n    });\r\n  }\r\n\r\n  onCancel() {\r\n    this.router.navigate(['../../'], { relativeTo: this.route });\r\n  }\r\n\r\n  showToast(message: string, error = false) {\r\n    this.toastMessage = message;\r\n    if (error) {\r\n      this.toastMessage += '';\r\n    }\r\n    clearTimeout(this.toastTimeout);\r\n    this.toastTimeout = setTimeout(() => {\r\n      this.toastMessage = null;\r\n    }, 2000);\r\n  }\r\n} ","<div class=\"card mb-4\" *ngIf=\"user$ | async as user; else loading\">\r\n  <div class=\"card-header\">\r\n    <h5 class=\"mb-0\"><i class=\"fas fa-user-edit me-2\"></i> Edit User</h5>\r\n  </div>\r\n  <div class=\"card-body\">\r\n    <app-user-form\r\n      [user]=\"user\"\r\n      [mode]=\"'edit'\"\r\n      [availableRoles$]=\"availableRoles$\"\r\n      (submitUser)=\"onSubmit($event, user)\"\r\n      (cancel)=\"onCancel()\"\r\n    ></app-user-form>\r\n    <div *ngIf=\"toastMessage\" class=\"toast-message fade-in mt-3\">{{ toastMessage }}</div>\r\n  </div>\r\n</div>\r\n<ng-template #loading>\r\n  <div class=\"text-center py-5\">\r\n    <div class=\"spinner-border text-primary\" role=\"status\"></div>\r\n    <div class=\"mt-2\">Loading user...</div>\r\n  </div>\r\n</ng-template> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}